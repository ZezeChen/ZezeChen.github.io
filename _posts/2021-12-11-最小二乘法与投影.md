---
layout : post
pid : 25
title: 最小二乘法与投影
date: 2021-12-11  
category: Math
---

设有向量$\mathbf{Y},\bm{1},\bm{X_1},\bm{X_2},\cdots,\bm{X_k} $，全空间为$V$,内有子空间$U=span(\bm{1},\bm{X_1},\bm{X_2},\cdots,\bm{X_k})$,令$\bm{X}=[\bm{1},\bm{X_1},\bm{X_2},\cdots,\bm{X_k}]$.假设$\bm{1},\bm{X_1},\bm{X_2},\cdots,\bm{X_k}$线性无关,那么这组向量是$U$的一组基，故$\forall \bm{\hat{y}}\in U, \bm{\hat{y}}=\bm{X\beta}$.

给定$\bm{Y}\in V$,任取$ \bm{\hat{y}}\in U, \bm{\hat{y}}=\bm{X\beta}$,那么

$$
||\bm{Y}- \bm{\hat{y}}||\geq ||\bm{Y}-P_U \bm{Y}||
$$

等号成立当且仅当

$$
[ \bm{\hat{y}}=P_U \bm{Y}
$$

此时有


$$
    \begin{aligned}
            & \bm{X} ^T (\bm{Y}- \bm{\hat{y}})=\bm{0}\\
    =& \bm{X} ^T (\bm{Y}-\bm{X\beta})\\
    =& \bm{X} ^T \bm{Y}-\bm{X}^T \bm{X\beta}\\
    \\
    \rightarrow & \bm{\beta}=(\bm{X}^T\bm{X})^{-1}\bm{X}^T \bm{Y}\\
    & \bm{\hat{y}}=\bm{X\beta}=\bm{X}(\bm{X}^T\bm{X})^{-1}\bm{X}^T \bm{Y}\\
    \end{aligned}
$$


可以看出，最小二乘法的本质是求 $\bm{Y}$ 到 $\bm{U}$ 的投影$\bm{\hat{y}}$ .

